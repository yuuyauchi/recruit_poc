# 関数クイックリファレンス

## 📊 全関数一覧表

| # | 関数名 | カテゴリ | 出力 | 構文例 | 結果例 |
|---|--------|---------|------|--------|--------|
| 1 | **SUM** | 数値計算 | 🔷単一 | `=SUM(A1:A10)` | `5500` |
| 2 | **AVERAGE** | 数値計算 | 🔷単一 | `=AVERAGE(80, 90, 100)` | `90` |
| 3 | **COUNT** | 数値計算 | 🔷単一 | `=COUNT(A1:A10)` | `10` |
| 4 | **MAX** | 数値計算 | 🔷単一 | `=MAX(50, 120, 75)` | `120` |
| 5 | **MIN** | 数値計算 | 🔷単一 | `=MIN(50, 120, 75)` | `50` |
| 6 | **ROUND** | 数値計算 | 🔷単一 | `=ROUND(123.456, 2)` | `123.46` |
| 7 | **IF** | 論理 | 🔷単一 | `=IF(A1>=60, "合格", "不合格")` | `合格` |
| 8 | **AND** | 論理 | 🔷単一 | `=AND(A1>=60, B1>=60)` | `TRUE` |
| 9 | **OR** | 論理 | 🔷単一 | `=OR(A1="営業", A1="企画")` | `TRUE` |
| 10 | **IFERROR** | 論理 | 🔷単一 | `=IFERROR(A1/B1, 0)` | `0` |
| 11 | **ISNUMBER** | 論理 | 🔷単一 | `=ISNUMBER("123")` | `TRUE` |
| 12 | **CONCATENATE** | 文字列 | 🔷単一 | `=CONCATENATE("姓：", A1)` | `姓：佐藤` |
| 13 | **LEFT** | 文字列 | 🔷単一 | `=LEFT("佐藤 太郎", 2)` | `佐藤` |
| 14 | **RIGHT** | 文字列 | 🔷単一 | `=RIGHT("佐藤 太郎", 2)` | `太郎` |
| 15 | **LEN** | 文字列 | 🔷単一 | `=LEN("佐藤 太郎")` | `5` |
| 16 | **SEARCH** | 文字列 | 🔷単一 | `=SEARCH("藤", "佐藤 太郎")` | `2` |
| 17 | **TODAY** | 日付 | 🔷単一 | `=TODAY()` | `2026-01-30` |
| 18 | **DATE** | 日付 | 🔷単一 | `=DATE(2025, 12, 31)` | `2025-12-31` |
| 19 | **YEAR** | 日付 | 🔷単一 | `=YEAR("2025-06-15")` | `2025` |
| 20 | **MONTH** | 日付 | 🔷単一 | `=MONTH("2025-06-15")` | `6` |
| 21 | **DAY** | 日付 | 🔷単一 | `=DAY("2025-06-15")` | `15` |
| 22 | **DATEDIF** | 日付 | 🔷単一 | `=DATEDIF("2020-01-01", "2025-01-01", "Y")` | `5` |
| 23 | **COUNTIF** | 条件集計 | 🔷単一 | `=COUNTIF(B:B, "*佐藤*")` | `50` |
| 24 | **SUMIF** | 条件集計 | 🔷単一 | `=SUMIF(C:C, "営業部", D:D)` | `25000000` |
| 25 | **COUNTIFS** | 条件集計 | 🔷単一 | `=COUNTIFS(C:C, "営業", D:D, "課長")` | `15` |
| 26 | **SUMIFS** | 条件集計 | 🔷単一 | `=SUMIFS(E:E, C:C, "営業", D:D, "課長")` | `5500000` |
| 27 | **VLOOKUP** | 検索参照 | 🔷単一 | `=VLOOKUP("037", A:E, 2, FALSE)` | `佐藤 誠` |
| 28 | **INDEX** | 検索参照 | 🔷単一 | `=INDEX(A1:E10, 5, 2)` | `鈴木 花子` |
| 29 | **MATCH** | 検索参照 | 🔷単一 | `=MATCH("佐藤", B:B, 0)` | `38` |
| 30 | **FILTER** | 配列 | 🔶複数* | `=FILTER(A:E, "佐藤", B:B)` | `[50行のデータ]` |
| 31 | **SHOWDATA** | デバッグ | 🔶複数* | `=SHOWDATA(A:E, 10)` | `[10行のプレビュー]` |

*現在の実装では複数行を文字列化して単一セルに表示

---

## 🎯 用途別クイックガイド

### データ抽出・検索
```excel
=FILTER(A:E, "佐藤", B:B)           # B列から「佐藤」を含む行を抽出
=VLOOKUP("037", A:E, 2, FALSE)     # IDから氏名を検索
=COUNTIF(B:B, "*佐藤*")            # 「佐藤」を含むセルの個数
```

### 条件付き集計
```excel
=SUMIF(C:C, "営業部", E:E)                    # 営業部の合計
=COUNTIFS(C:C, "営業部", D:D, "課長")        # 営業部の課長の人数
=SUMIFS(E:E, C:C, "営業部", E:E, ">=2020")  # 営業部の2020年以降の合計
```

### 文字列操作
```excel
=LEFT(B2, 2)                       # 姓を抽出
=CONCATENATE(B2, " (", C2, ")")   # "佐藤 太郎 (営業部)"
=LEN(B2)                           # 文字数をカウント
```

### 日付計算
```excel
=DATEDIF(E2, TODAY(), "Y")        # 勤続年数
=YEAR(E2)                          # 入社年
=IF(YEAR(E2)>=2020, "新人", "ベテラン")  # 入社年で分類
```

### エラー処理
```excel
=IFERROR(VLOOKUP(A1, B:C, 2, FALSE), "該当なし")
=IF(ISNUMBER(A1), A1*2, "数値ではありません")
```

---

## 📈 カテゴリ別統計

| カテゴリ | 関数数 | 主な用途 |
|---------|--------|---------|
| 数値計算 | 6 | 合計、平均、最大・最小、四捨五入 |
| 論理・条件判定 | 5 | IF文、AND/OR、エラー処理、型チェック |
| 文字列操作 | 5 | 連結、抽出、検索、長さ |
| 日付処理 | 6 | 今日の日付、日付作成、年月日抽出、期間計算 |
| 条件付き集計 | 4 | COUNTIF/SUMIF系（単一・複数条件） |
| 検索・参照 | 3 | VLOOKUP、INDEX、MATCH |
| 配列操作 | 1 | FILTER（条件による抽出） |
| デバッグ | 1 | SHOWDATA（データ確認） |

**合計: 31関数**

---

## 🔷 単一セル vs 🔶 複数セル

### 🔷 単一セル出力（29関数）
結果が1つの値として表示されます。
- 数値: `5500`
- 文字列: `佐藤 太郎`
- 真偽値: `TRUE`
- 日付: `2026-01-30`

### 🔶 複数セル相当の出力（2関数）
本来は複数セルにまたがる結果を返しますが、現在の実装では見やすい文字列に変換して単一セルに表示：

**FILTER関数**:
```
[結果: 50行]
037, 佐藤 誠, IT部, 係長, 2024
069, 佐藤 絢香, 営業部, 課長, 2024
...
```

**SHOWDATA関数**:
```
501行のデータ:
ID | 氏名 | 部署 | 役職 | 入社年
001 | 吉田 大樹 | 営業部 | 主任 | 2009
...
```

---

## 💡 よく使う組み合わせパターン

### パターン1: 安全な検索
```excel
=IFERROR(VLOOKUP(A1, B:C, 2, FALSE), "見つかりません")
```

### パターン2: 複数条件でカウント
```excel
=COUNTIFS(C:C, "営業部", D:D, "課長", E:E, ">=2020")
```

### パターン3: 条件付きメッセージ
```excel
=IF(COUNTIF(B:B, "*佐藤*")>0, "佐藤さんがいます", "いません")
```

### パターン4: 勤続年数計算
```excel
=DATEDIF(E2, TODAY(), "Y") & "年" & DATEDIF(E2, TODAY(), "YM") & "ヶ月"
```

### パターン5: 部分一致検索
```excel
=COUNTIF(B:B, "*" & G1 & "*")
```
（G1セルの値を含む行をカウント）

---

## ⚡ パフォーマンスのヒント

### 効率的な範囲指定
```excel
❌ 避ける: =SUM(A:A)              # 列全体（遅い場合がある）
✅ 推奨: =SUM(A1:A500)            # 必要な範囲のみ
```

### 関数のネストを最小限に
```excel
❌ 複雑: =IF(IF(IF(A1>100, "大", "中")="大", "特大", "普通")="特大", "XXL", "L")
✅ シンプル: =IF(A1>100, "XXL", "L")
```

### エラーハンドリングを活用
```excel
✅ 安全: =IFERROR(計算式, デフォルト値)
```

---

## 📚 関連ドキュメント

- **詳細リファレンス**: `FUNCTION_REFERENCE.md`
- **実装計画**: `IMPLEMENTATION_SUMMARY.md`
- **FILTERエラー修正**: `FILTER_FIX_SUMMARY.md`
